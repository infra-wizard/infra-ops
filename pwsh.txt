#!/usr/bin/env pwsh

# =========== Created with CLI version 1.26.0 ===========

function ExecAndGetMigrationID {
    param (
        [scriptblock]$ScriptBlock
    )
    $MigrationID = & @ScriptBlock | ForEach-Object {
        Write-Host $_
        $_
    } | Select-String -Pattern "\(ID: (.+)\)" | ForEach-Object { $_.matches.groups[1] }
    return $MigrationID
}

if (-not $env:GH_PAT) {
    Write-Error "GH_PAT environment variable must be set to a valid GitHub Personal Access Token with the appropriate scopes. For more information see https://docs.github.com/en/migrations/using-github-enterprise-importer/preparing-to-migrate-with-github-enterprise-importer/managing-access-for-github-enterprise-importer#creating-a-personal-access-token-for-github-enterprise-importer"
    exit 1
} else {
    Write-Host "GH_PAT environment variable is set and will be used to authenticate to GitHub."
}

$Succeeded = 0
$Failed = 0
$RepoMigrations = [ordered]@{}

# =========== Organization: Trail-Tech ===========

# === Queuing repo migrations ===
$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "apple-mfid-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "apple-mfid-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["apple-mfid-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "audio-hal" --github-target-org "Polaris-InVehicleSoftware" --target-repo "audio-hal" --queue-only --target-repo-visibility private }
$RepoMigrations["audio-hal"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "audiomanager-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "audiomanager-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["audiomanager-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "backlightd" --github-target-org "Polaris-InVehicleSoftware" --target-repo "backlightd" --queue-only --target-repo-visibility private }
$RepoMigrations["backlightd"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "bluetooth-connection-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "bluetooth-connection-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["bluetooth-connection-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "bluetooth-message-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "bluetooth-message-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["bluetooth-message-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "bluetooth-phonebook-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "bluetooth-phonebook-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["bluetooth-phonebook-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "bluetooth-telephony-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "bluetooth-telephony-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["bluetooth-telephony-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "bluez" --github-target-org "Polaris-InVehicleSoftware" --target-repo "bluez" --queue-only --target-repo-visibility private }
$RepoMigrations["bluez"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "bt-connection-service" --github-target-org "Polaris-InVehicleSoftware" --target-repo "bt-connection-service" --queue-only --target-repo-visibility private }
$RepoMigrations["bt-connection-service"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "c2b-fw" --github-target-org "Polaris-InVehicleSoftware" --target-repo "c2b-fw" --queue-only --target-repo-visibility private }
$RepoMigrations["c2b-fw"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "common-projection-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "common-projection-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["common-projection-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "libvehicle" --github-target-org "Polaris-InVehicleSoftware" --target-repo "libvehicle" --queue-only --target-repo-visibility private }
$RepoMigrations["libvehicle"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "cvcproxy" --github-target-org "Polaris-InVehicleSoftware" --target-repo "cvcproxy" --queue-only --target-repo-visibility private }
$RepoMigrations["cvcproxy"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "timezone-service" --github-target-org "Polaris-InVehicleSoftware" --target-repo "timezone-service" --queue-only --target-repo-visibility private }
$RepoMigrations["timezone-service"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "GroupRide" --github-target-org "Polaris-InVehicleSoftware" --target-repo "GroupRide" --queue-only --target-repo-visibility private }
$RepoMigrations["GroupRide"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "radio-complianced" --github-target-org "Polaris-InVehicleSoftware" --target-repo "radio-complianced" --queue-only --target-repo-visibility private }
$RepoMigrations["radio-complianced"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "janus" --github-target-org "Polaris-InVehicleSoftware" --target-repo "janus" --queue-only --target-repo-visibility private }
$RepoMigrations["janus"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "lib-apple-commplugin" --github-target-org "Polaris-InVehicleSoftware" --target-repo "lib-apple-commplugin" --queue-only --target-repo-visibility private }
$RepoMigrations["lib-apple-commplugin"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "libdbuswrapper" --github-target-org "Polaris-InVehicleSoftware" --target-repo "libdbuswrapper" --queue-only --target-repo-visibility private }
$RepoMigrations["libdbuswrapper"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "debuglogger" --github-target-org "Polaris-InVehicleSoftware" --target-repo "debuglogger" --queue-only --target-repo-visibility private }
$RepoMigrations["debuglogger"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-tiles" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-tiles" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-tiles"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-modemd" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-modemd" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-modemd"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-cvc" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-cvc" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-cvc"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-user" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-user" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-user"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "media-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "media-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["media-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-carplay-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-carplay-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-carplay-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-common-infra-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-common-infra-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-common-infra-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-disks" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-disks" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-disks"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-gps" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-gps" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-gps"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-libsnf" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-libsnf" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-libsnf"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-tts" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-tts" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-tts"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-persistence" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-persistence" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-persistence"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-thermald" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-thermald" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-thermald"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-tuner-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-tuner-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-tuner-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-vcard-parser" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-vcard-parser" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-vcard-parser"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-video" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-video" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-video"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "powermanagerd" --github-target-org "Polaris-InVehicleSoftware" --target-repo "powermanagerd" --queue-only --target-repo-visibility private }
$RepoMigrations["powermanagerd"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "pulseaudio" --github-target-org "Polaris-InVehicleSoftware" --target-repo "pulseaudio" --queue-only --target-repo-visibility private }
$RepoMigrations["pulseaudio"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "mapbox-gl-native" --github-target-org "Polaris-InVehicleSoftware" --target-repo "mapbox-gl-native" --queue-only --target-repo-visibility private }
$RepoMigrations["mapbox-gl-native"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "sfI-linux-chardev-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "sfI-linux-chardev-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["sfI-linux-chardev-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "speaker-hal" --github-target-org "Polaris-InVehicleSoftware" --target-repo "speaker-hal" --queue-only --target-repo-visibility private }
$RepoMigrations["speaker-hal"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "polaris-utils" --github-target-org "Polaris-InVehicleSoftware" --target-repo "polaris-utils" --queue-only --target-repo-visibility private }
$RepoMigrations["polaris-utils"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "ubxfwupdate" --github-target-org "Polaris-InVehicleSoftware" --target-repo "ubxfwupdate" --queue-only --target-repo-visibility private }
$RepoMigrations["ubxfwupdate"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "variant-config-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "variant-config-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["variant-config-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "vehicle-services-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "vehicle-services-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["vehicle-services-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "venus-styles" --github-target-org "Polaris-InVehicleSoftware" --target-repo "venus-styles" --queue-only --target-repo-visibility private }
$RepoMigrations["venus-styles"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "vip-rcip" --github-target-org "Polaris-InVehicleSoftware" --target-repo "vip-rcip" --queue-only --target-repo-visibility private }
$RepoMigrations["vip-rcip"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "vpro-vnc" --github-target-org "Polaris-InVehicleSoftware" --target-repo "vpro-vnc" --queue-only --target-repo-visibility private }
$RepoMigrations["vpro-vnc"] = $MigrationID

$MigrationID = ExecAndGetMigrationID { gh gei migrate-repo --github-source-org "Trail-Tech" --source-repo "winchctrld" --github-target-org "Polaris-InVehicleSoftware" --target-repo "winchctrld" --queue-only --target-repo-visibility private }
$RepoMigrations["winchctrld"] = $MigrationID

# =========== Waiting for all migrations to finish for Organization: Trail-Tech ===========

if ($RepoMigrations["apple-mfid-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["apple-mfid-rcip"] }
if ($RepoMigrations["apple-mfid-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["audio-hal"]) { gh gei wait-for-migration --migration-id $RepoMigrations["audio-hal"] }
if ($RepoMigrations["audio-hal"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["audiomanager-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["audiomanager-rcip"] }
if ($RepoMigrations["audiomanager-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["backlightd"]) { gh gei wait-for-migration --migration-id $RepoMigrations["backlightd"] }
if ($RepoMigrations["backlightd"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["bluetooth-connection-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["bluetooth-connection-rcip"] }
if ($RepoMigrations["bluetooth-connection-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["bluetooth-message-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["bluetooth-message-rcip"] }
if ($RepoMigrations["bluetooth-message-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["bluetooth-phonebook-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["bluetooth-phonebook-rcip"] }
if ($RepoMigrations["bluetooth-phonebook-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["bluetooth-telephony-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["bluetooth-telephony-rcip"] }
if ($RepoMigrations["bluetooth-telephony-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["bluez"]) { gh gei wait-for-migration --migration-id $RepoMigrations["bluez"] }
if ($RepoMigrations["bluez"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["bt-connection-service"]) { gh gei wait-for-migration --migration-id $RepoMigrations["bt-connection-service"] }
if ($RepoMigrations["bt-connection-service"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["c2b-fw"]) { gh gei wait-for-migration --migration-id $RepoMigrations["c2b-fw"] }
if ($RepoMigrations["c2b-fw"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["common-projection-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["common-projection-rcip"] }
if ($RepoMigrations["common-projection-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["libvehicle"]) { gh gei wait-for-migration --migration-id $RepoMigrations["libvehicle"] }
if ($RepoMigrations["libvehicle"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["cvcproxy"]) { gh gei wait-for-migration --migration-id $RepoMigrations["cvcproxy"] }
if ($RepoMigrations["cvcproxy"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["timezone-service"]) { gh gei wait-for-migration --migration-id $RepoMigrations["timezone-service"] }
if ($RepoMigrations["timezone-service"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["GroupRide"]) { gh gei wait-for-migration --migration-id $RepoMigrations["GroupRide"] }
if ($RepoMigrations["GroupRide"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["radio-complianced"]) { gh gei wait-for-migration --migration-id $RepoMigrations["radio-complianced"] }
if ($RepoMigrations["radio-complianced"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["janus"]) { gh gei wait-for-migration --migration-id $RepoMigrations["janus"] }
if ($RepoMigrations["janus"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["lib-apple-commplugin"]) { gh gei wait-for-migration --migration-id $RepoMigrations["lib-apple-commplugin"] }
if ($RepoMigrations["lib-apple-commplugin"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["libdbuswrapper"]) { gh gei wait-for-migration --migration-id $RepoMigrations["libdbuswrapper"] }
if ($RepoMigrations["libdbuswrapper"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["debuglogger"]) { gh gei wait-for-migration --migration-id $RepoMigrations["debuglogger"] }
if ($RepoMigrations["debuglogger"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-tiles"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-tiles"] }
if ($RepoMigrations["polaris-tiles"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-modemd"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-modemd"] }
if ($RepoMigrations["polaris-modemd"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-cvc"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-cvc"] }
if ($RepoMigrations["polaris-cvc"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-user"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-user"] }
if ($RepoMigrations["polaris-user"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["media-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["media-rcip"] }
if ($RepoMigrations["media-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-carplay-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-carplay-rcip"] }
if ($RepoMigrations["polaris-carplay-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-common-infra-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-common-infra-rcip"] }
if ($RepoMigrations["polaris-common-infra-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-disks"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-disks"] }
if ($RepoMigrations["polaris-disks"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-gps"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-gps"] }
if ($RepoMigrations["polaris-gps"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-libsnf"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-libsnf"] }
if ($RepoMigrations["polaris-libsnf"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-tts"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-tts"] }
if ($RepoMigrations["polaris-tts"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-persistence"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-persistence"] }
if ($RepoMigrations["polaris-persistence"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-thermald"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-thermald"] }
if ($RepoMigrations["polaris-thermald"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-tuner-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-tuner-rcip"] }
if ($RepoMigrations["polaris-tuner-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-vcard-parser"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-vcard-parser"] }
if ($RepoMigrations["polaris-vcard-parser"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-video"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-video"] }
if ($RepoMigrations["polaris-video"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["powermanagerd"]) { gh gei wait-for-migration --migration-id $RepoMigrations["powermanagerd"] }
if ($RepoMigrations["powermanagerd"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["pulseaudio"]) { gh gei wait-for-migration --migration-id $RepoMigrations["pulseaudio"] }
if ($RepoMigrations["pulseaudio"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["mapbox-gl-native"]) { gh gei wait-for-migration --migration-id $RepoMigrations["mapbox-gl-native"] }
if ($RepoMigrations["mapbox-gl-native"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["sfI-linux-chardev-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["sfI-linux-chardev-rcip"] }
if ($RepoMigrations["sfI-linux-chardev-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["speaker-hal"]) { gh gei wait-for-migration --migration-id $RepoMigrations["speaker-hal"] }
if ($RepoMigrations["speaker-hal"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["polaris-utils"]) { gh gei wait-for-migration --migration-id $RepoMigrations["polaris-utils"] }
if ($RepoMigrations["polaris-utils"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["ubxfwupdate"]) { gh gei wait-for-migration --migration-id $RepoMigrations["ubxfwupdate"] }
if ($RepoMigrations["ubxfwupdate"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["variant-config-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["variant-config-rcip"] }
if ($RepoMigrations["variant-config-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["vehicle-services-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["vehicle-services-rcip"] }
if ($RepoMigrations["vehicle-services-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["venus-styles"]) { gh gei wait-for-migration --migration-id $RepoMigrations["venus-styles"] }
if ($RepoMigrations["venus-styles"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["vip-rcip"]) { gh gei wait-for-migration --migration-id $RepoMigrations["vip-rcip"] }
if ($RepoMigrations["vip-rcip"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["vpro-vnc"]) { gh gei wait-for-migration --migration-id $RepoMigrations["vpro-vnc"] }
if ($RepoMigrations["vpro-vnc"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }

if ($RepoMigrations["winchctrld"]) { gh gei wait-for-migration --migration-id $RepoMigrations["winchctrld"] }
if ($RepoMigrations["winchctrld"] -and $lastexitcode -eq 0) { $Succeeded++ } else { $Failed++ }


Write-Host =============== Summary ===============
Write-Host Total number of successful migrations: $Succeeded
Write-Host Total number of failed migrations: $Failed

if ($Failed -ne 0) {
    exit 1
}
